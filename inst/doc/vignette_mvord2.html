<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Rainer Hirk, Kurt Hornik and Laura Vana" />

<meta name="date" content="2024-07-07" />

<title>mvord: Additional examples</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">mvord: Additional examples</h1>
<h4 class="author">Rainer Hirk, Kurt Hornik and Laura Vana</h4>
<h4 class="date">2024-07-07</h4>


<div id="TOC">
<ul>
<li><a href="#example-1---a-simple-example-with-2-raters" id="toc-example-1---a-simple-example-with-2-raters">Example 1 - A simple
example with 2 raters</a></li>
<li><a href="#example-2---a-simple-example-with-3-raters" id="toc-example-2---a-simple-example-with-3-raters">Example 2 - A simple
example with 3 raters</a></li>
<li><a href="#example-3a---a-model-of-firm-ratings-assigned-by-multiple-raters-and-an-investment-speculative-grade-indicator" id="toc-example-3a---a-model-of-firm-ratings-assigned-by-multiple-raters-and-an-investment-speculative-grade-indicator">Example
3a - A model of firm ratings assigned by multiple raters and an
investment-speculative grade indicator</a></li>
<li><a href="#example-3b---a-more-elaborate-model-of-ratings-assigned-by-multiple-raters" id="toc-example-3b---a-more-elaborate-model-of-ratings-assigned-by-multiple-raters">Example
3b - A more elaborate model of ratings assigned by multiple
raters</a></li>
<li><a href="#example-4---a-longitudinal-model" id="toc-example-4---a-longitudinal-model">Example 4 - A longitudinal
model</a></li>
<li><a href="#example-5---self-reported-health-status" id="toc-example-5---self-reported-health-status">Example 5 -
Self-reported health status</a></li>
<li><a href="#example-6---multirater-agreement-data" id="toc-example-6---multirater-agreement-data">Example 6 - Multirater
agreement data</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<p>Load package <strong>mvord</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(mvord)</span></code></pre></div>
<p>Load data set</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;data_cr&quot;</span>, <span class="at">package =</span> <span class="st">&quot;mvord&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">str</span>(data_cr, <span class="at">vec.len =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    690 obs. of  10 variables:
##  $ rater1 : Ord.factor w/ 5 levels &quot;A&quot;&lt;&quot;B&quot;&lt;&quot;C&quot;&lt;&quot;D&quot;&lt;..: 2 3 3 2 5 4 3 4 ...
##  $ rater2 : Ord.factor w/ 5 levels &quot;A&quot;&lt;&quot;B&quot;&lt;&quot;C&quot;&lt;&quot;D&quot;&lt;..: 2 4 4 2 5 NA 3 4 ...
##  $ rater3 : Ord.factor w/ 6 levels &quot;F&quot;&lt;&quot;G&quot;&lt;&quot;H&quot;&lt;&quot;I&quot;&lt;..: 3 NA NA NA 6 NA 2 5 ...
##  $ rater4 : Ord.factor w/ 2 levels &quot;L&quot;&lt;&quot;M&quot;: 1 2 2 1 2 2 2 2 ...
##  $ firm_id: int  1 2 3 4 5 6 7 8 ...
##  $ LR     : num  1.72 1.84 2.64 1.31 ...
##  $ LEV    : num  2.114 0.883 2.3 2.638 ...
##  $ PR     : num  0.3779 -0.1503 -0.0521 0.3289 ...
##  $ RSIZE  : num  -6.37 -7.84 -7.98 -5.86 ...
##  $ BETA   : num  0.836 0.49 0.802 1.137 ...</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">head</span>(data_cr, <span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   rater1 rater2 rater3 rater4 firm_id       LR       LEV          PR     RSIZE
## 1      B      B      H      L       1 1.720041 2.1144513  0.37792213 -6.365053
## 2      C      D   &lt;NA&gt;      M       2 1.836574 0.8826725 -0.15032402 -7.839813
## 3      C      D   &lt;NA&gt;      M       3 2.638177 2.2997237 -0.05205389 -7.976650
##        BETA
## 1 0.8358773
## 2 0.4895358
## 3 0.8022900</code></pre>
<div id="example-1---a-simple-example-with-2-raters" class="section level2">
<h2>Example 1 - A simple example with 2 raters</h2>
<p>We introduce a simple example with 2 raters (<code>rater1</code> and
<code>rater2</code>) rating a set of firms. The data set
<code>data_cr</code> has a wide format and hence, we apply the multiple
measurement object <code>MMO2</code> on the left-hand side of the
formula object. The firm-level covariates <code>LR</code>,
<code>LEV</code>, <code>PR</code>, <code>RSIZE</code>, <code>BETA</code>
are passed on the right-hand side of the formula. The thresholds are set
equal by the argument <code>thresholds.constraints</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>res_cor_probit_2raters <span class="ot">&lt;-</span> <span class="fu">mvord</span>(<span class="at">formula =</span> <span class="fu">MMO2</span>(rater1, rater2) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> LR <span class="sc">+</span> LEV <span class="sc">+</span> PR <span class="sc">+</span> RSIZE <span class="sc">+</span> BETA,</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>                               <span class="at">threshold.constraints =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                               <span class="at">data =</span> data_cr)</span></code></pre></div>
<p>The results are displayed by:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">summary</span>(res_cor_probit_2raters)</span></code></pre></div>
<pre><code>## 
## Call: mvord(formula = MMO2(rater1, rater2) ~ 0 + LR + LEV + PR + RSIZE + 
##     BETA, data = data_cr, threshold.constraints = c(1, 1))
## 
## Formula: MMO2(rater1, rater2) ~ 0 + LR + LEV + PR + RSIZE + BETA
## 
##     link threshold nsubjects ndim   logPL   CLAIC   CLBIC fevals
## mvprobit  flexible       690    2 -799.84 1630.35 1699.91   4476
## 
## Thresholds:
##            Estimate Std. Error z value  Pr(&gt;|z|)    
## rater1 A|B  8.40533    0.39600  21.225 &lt; 2.2e-16 ***
## rater1 B|C  9.87574    0.42661  23.149 &lt; 2.2e-16 ***
## rater1 C|D 11.68478    0.46471  25.145 &lt; 2.2e-16 ***
## rater1 D|E 14.00771    0.53773  26.050 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Coefficients:
##          Estimate Std. Error  z value  Pr(&gt;|z|)    
## LR 1     0.191816   0.059864   3.2042  0.001354 ** 
## LR 2     0.089982   0.069426   1.2961  0.194945    
## LEV 1    0.456824   0.039714  11.5027 &lt; 2.2e-16 ***
## LEV 2    0.441115   0.044323   9.9522 &lt; 2.2e-16 ***
## PR 1    -2.626680   0.174938 -15.0149 &lt; 2.2e-16 ***
## PR 2    -2.761407   0.203692 -13.5567 &lt; 2.2e-16 ***
## RSIZE 1 -1.166859   0.050982 -22.8877 &lt; 2.2e-16 ***
## RSIZE 2 -1.184520   0.050259 -23.5685 &lt; 2.2e-16 ***
## BETA 1   1.644008   0.100520  16.3550 &lt; 2.2e-16 ***
## BETA 2   1.741845   0.128536  13.5515 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Error Structure:
##                    Estimate Std. Error z value  Pr(&gt;|z|)    
## corr rater1 rater2 0.872025   0.025461   34.25 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The coefficients can be extracted by:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">coef</span>(res_cor_probit_2raters)</span></code></pre></div>
<pre><code>##        LR 1        LR 2       LEV 1       LEV 2        PR 1        PR 2 
##  0.19181645  0.08998178  0.45682446  0.44111540 -2.62668045 -2.76140750 
##     RSIZE 1     RSIZE 2      BETA 1      BETA 2 
## -1.16685941 -1.18452031  1.64400778  1.74184468</code></pre>
</div>
<div id="example-2---a-simple-example-with-3-raters" class="section level2">
<h2>Example 2 - A simple example with 3 raters</h2>
<p>A simple example with 3 raters (<code>rater1</code>,
<code>rater2</code> and <code>rater3</code>) is presented. The
regression coefficients are set equal by the argument
<code>coef.constraints</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>res_cor_logit_3raters <span class="ot">&lt;-</span> <span class="fu">mvord</span>(<span class="at">formula =</span> <span class="fu">MMO2</span>(rater1, rater2, rater <span class="dv">3</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> LR <span class="sc">+</span> LEV <span class="sc">+</span> PR <span class="sc">+</span> RSIZE <span class="sc">+</span> BETA,</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>                               <span class="at">coef.constraints =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>                               <span class="at">data =</span> data_cr,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>                               <span class="at">link =</span> <span class="fu">mvlogit</span>())</span></code></pre></div>
<p>The results are displayed by:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">summary</span>(res_cor_logit_3raters)</span></code></pre></div>
<pre><code>## 
## Call: mvord(formula = MMO2(rater1, rater2, rater3) ~ 0 + LR + LEV + 
##     PR + RSIZE + BETA, data = data_cr, link = mvlogit(), coef.constraints = c(1, 
##     1, 1))
## 
## Formula: MMO2(rater1, rater2, rater3) ~ 0 + LR + LEV + PR + RSIZE + BETA
## 
##    link threshold nsubjects ndim   logPL   CLAIC   CLBIC fevals
## mvlogit  flexible       690    3 -1561.4 3194.64 3357.58   4063
## 
## Thresholds:
##            Estimate Std. Error z value  Pr(&gt;|z|)    
## rater1 A|B 14.71272    0.84962  17.317 &lt; 2.2e-16 ***
## rater1 B|C 17.46130    0.92699  18.837 &lt; 2.2e-16 ***
## rater1 C|D 20.65827    1.03917  19.880 &lt; 2.2e-16 ***
## rater1 D|E 24.68643    1.20698  20.453 &lt; 2.2e-16 ***
## rater2 A|B 14.87018    0.85299  17.433 &lt; 2.2e-16 ***
## rater2 B|C 17.43895    0.93096  18.732 &lt; 2.2e-16 ***
## rater2 C|D 20.47187    1.04358  19.617 &lt; 2.2e-16 ***
## rater2 D|E 24.80043    1.22174  20.299 &lt; 2.2e-16 ***
## rater3 F|G 14.66329    0.86375  16.976 &lt; 2.2e-16 ***
## rater3 G|H 17.35097    0.92572  18.743 &lt; 2.2e-16 ***
## rater3 H|I 20.73808    1.04700  19.807 &lt; 2.2e-16 ***
## rater3 I|J 23.25683    1.15044  20.215 &lt; 2.2e-16 ***
## rater3 J|K 25.33847    1.22854  20.625 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Coefficients:
##          Estimate Std. Error  z value  Pr(&gt;|z|)    
## LR 1     0.333597   0.112624   2.9621  0.003056 ** 
## LEV 1    0.746847   0.076165   9.8057 &lt; 2.2e-16 ***
## PR 1    -4.930264   0.356519 -13.8289 &lt; 2.2e-16 ***
## RSIZE 1 -2.073424   0.108015 -19.1958 &lt; 2.2e-16 ***
## BETA 1   3.021150   0.222735  13.5639 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Error Structure:
##                    Estimate Std. Error z value  Pr(&gt;|z|)    
## corr rater1 rater2 0.866603   0.027446  31.575 &lt; 2.2e-16 ***
## corr rater1 rater3 0.903774   0.024724  36.554 &lt; 2.2e-16 ***
## corr rater2 rater3 0.822654   0.045875  17.933 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The threshold parameters are presented by:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">thresholds</span>(res_cor_logit_3raters)</span></code></pre></div>
<pre><code>## $rater1
##      A|B      B|C      C|D      D|E 
## 14.71272 17.46130 20.65827 24.68643 
## 
## $rater2
##      A|B      B|C      C|D      D|E 
## 14.87018 17.43895 20.47187 24.80043 
## 
## $rater3
##      F|G      G|H      H|I      I|J      J|K 
## 14.66329 17.35097 20.73808 23.25683 25.33847</code></pre>
</div>
<div id="example-3a---a-model-of-firm-ratings-assigned-by-multiple-raters-and-an-investment-speculative-grade-indicator" class="section level2">
<h2>Example 3a - A model of firm ratings assigned by multiple raters and
an investment-speculative grade indicator</h2>
<p>This example presents a four dimensional ordinal regression model
with probit link and a general correlation error structure
<code>cor_general(~ 1)</code>. The fourth rater only rates the firms on
a binary scale: investment grade vs. speculative grade.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>res_cor_probit_simple <span class="ot">&lt;-</span> <span class="fu">mvord</span>(<span class="at">formula =</span> <span class="fu">MMO2</span>(rater1, rater2, rater3, rater4) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> LR <span class="sc">+</span> LEV <span class="sc">+</span> PR <span class="sc">+</span> RSIZE <span class="sc">+</span> BETA, <span class="at">data =</span> data_cr)</span></code></pre></div>
<p>The results are displayed by:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">summary</span>(res_cor_probit_simple)</span></code></pre></div>
<pre><code>## 
## Call: mvord(formula = MMO2(rater1, rater2, rater3, rater4) ~ 0 + LR + 
##     LEV + PR + RSIZE + BETA, data = data_cr)
## 
## Formula: MMO2(rater1, rater2, rater3, rater4) ~ 0 + LR + LEV + PR + RSIZE + 
##     BETA
## 
##     link threshold nsubjects ndim    logPL   CLAIC   CLBIC fevals
## mvprobit  flexible       690    4 -2925.83 6037.38 6458.64  15701
## 
## Thresholds:
##            Estimate Std. Error z value  Pr(&gt;|z|)    
## rater1 A|B  8.04920    0.44306  18.167 &lt; 2.2e-16 ***
## rater1 B|C  9.56783    0.47381  20.194 &lt; 2.2e-16 ***
## rater1 C|D 11.34991    0.51747  21.933 &lt; 2.2e-16 ***
## rater1 D|E 13.51638    0.60129  22.479 &lt; 2.2e-16 ***
## rater2 A|B  8.59513    0.49834  17.247 &lt; 2.2e-16 ***
## rater2 B|C 10.05454    0.53941  18.640 &lt; 2.2e-16 ***
## rater2 C|D 11.85857    0.59749  19.847 &lt; 2.2e-16 ***
## rater2 D|E 14.33336    0.70092  20.450 &lt; 2.2e-16 ***
## rater3 F|G  8.24303    0.51775  15.921 &lt; 2.2e-16 ***
## rater3 G|H  9.77659    0.55593  17.586 &lt; 2.2e-16 ***
## rater3 H|I 11.70601    0.62343  18.777 &lt; 2.2e-16 ***
## rater3 I|J 13.09380    0.68810  19.029 &lt; 2.2e-16 ***
## rater3 J|K 14.17279    0.72153  19.643 &lt; 2.2e-16 ***
## rater4 L|M 13.52691    1.00085  13.515 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Coefficients:
##          Estimate Std. Error  z value  Pr(&gt;|z|)    
## LR 1     0.208652   0.068020   3.0675  0.002159 ** 
## LR 2     0.153212   0.073420   2.0868  0.036906 *  
## LR 3     0.180531   0.078643   2.2956  0.021700 *  
## LR 4     0.150887   0.111750   1.3502  0.176944    
## LEV 1    0.430213   0.043774   9.8281 &lt; 2.2e-16 ***
## LEV 2    0.432842   0.050129   8.6346 &lt; 2.2e-16 ***
## LEV 3    0.399459   0.050826   7.8594 3.861e-15 ***
## LEV 4    0.624967   0.074146   8.4289 &lt; 2.2e-16 ***
## PR 1    -2.573616   0.194046 -13.2629 &lt; 2.2e-16 ***
## PR 2    -2.827056   0.217061 -13.0242 &lt; 2.2e-16 ***
## PR 3    -2.678170   0.222705 -12.0257 &lt; 2.2e-16 ***
## PR 4    -2.793063   0.279732  -9.9848 &lt; 2.2e-16 ***
## RSIZE 1 -1.129967   0.056379 -20.0424 &lt; 2.2e-16 ***
## RSIZE 2 -1.196432   0.061776 -19.3671 &lt; 2.2e-16 ***
## RSIZE 3 -1.196481   0.066503 -17.9914 &lt; 2.2e-16 ***
## RSIZE 4 -1.565903   0.115749 -13.5285 &lt; 2.2e-16 ***
## BETA 1   1.602187   0.110868  14.4513 &lt; 2.2e-16 ***
## BETA 2   1.801526   0.140123  12.8567 &lt; 2.2e-16 ***
## BETA 3   1.517633   0.139319  10.8932 &lt; 2.2e-16 ***
## BETA 4   1.988644   0.203338   9.7800 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Error Structure:
##                    Estimate Std. Error z value  Pr(&gt;|z|)    
## corr rater1 rater2 0.875996   0.024554  35.677 &lt; 2.2e-16 ***
## corr rater1 rater3 0.913588   0.023462  38.940 &lt; 2.2e-16 ***
## corr rater1 rater4 0.896170   0.033495  26.755 &lt; 2.2e-16 ***
## corr rater2 rater3 0.831679   0.042740  19.459 &lt; 2.2e-16 ***
## corr rater2 rater4 0.926139   0.031808  29.117 &lt; 2.2e-16 ***
## corr rater3 rater4 0.866521   0.051285  16.896 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The threshold coefficients can be extracted by:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">thresholds</span>(res_cor_probit_simple)</span></code></pre></div>
<pre><code>## $rater1
##       A|B       B|C       C|D       D|E 
##  8.049203  9.567831 11.349908 13.516375 
## 
## $rater2
##       A|B       B|C       C|D       D|E 
##  8.595126 10.054536 11.858567 14.333362 
## 
## $rater3
##       F|G       G|H       H|I       I|J       J|K 
##  8.243027  9.776591 11.706012 13.093799 14.172787 
## 
## $rater4
##      L|M 
## 13.52691</code></pre>
<p>The regression coefficients are obtained by:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">coef</span>(res_cor_probit_simple)</span></code></pre></div>
<pre><code>##       LR 1       LR 2       LR 3       LR 4      LEV 1      LEV 2      LEV 3 
##  0.2086517  0.1532119  0.1805309  0.1508872  0.4302126  0.4328417  0.3994591 
##      LEV 4       PR 1       PR 2       PR 3       PR 4    RSIZE 1    RSIZE 2 
##  0.6249669 -2.5736158 -2.8270564 -2.6781697 -2.7930627 -1.1299673 -1.1964316 
##    RSIZE 3    RSIZE 4     BETA 1     BETA 2     BETA 3     BETA 4 
## -1.1964814 -1.5659034  1.6021871  1.8015260  1.5176327  1.9886441</code></pre>
<p>The error structure for firm with <code>firm_id = 11</code> is
displayed by:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">error_structure</span>(res_cor_probit_simple)[[<span class="dv">11</span>]]</span></code></pre></div>
<pre><code>##           rater1    rater2    rater3    rater4
## rater1 1.0000000 0.8759965 0.9135876 0.8961703
## rater2 0.8759965 1.0000000 0.8316790 0.9261393
## rater3 0.9135876 0.8316790 1.0000000 0.8665213
## rater4 0.8961703 0.9261393 0.8665213 1.0000000</code></pre>
</div>
<div id="example-3b---a-more-elaborate-model-of-ratings-assigned-by-multiple-raters" class="section level2">
<h2>Example 3b - A more elaborate model of ratings assigned by multiple
raters</h2>
<p>In this example, we extend the setting of the above example by
imposing constraints on the regression as well as on the threshold
parameters and changing the link function to the multivariate logit
link.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>res_cor_logit <span class="ot">&lt;-</span> <span class="fu">mvord</span>(<span class="at">formula =</span> <span class="fu">MMO2</span>(rater1, rater2, rater3, rater4) <span class="sc">~</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>    <span class="dv">0</span> <span class="sc">+</span> LR <span class="sc">+</span> LEV <span class="sc">+</span> PR <span class="sc">+</span> RSIZE <span class="sc">+</span> BETA, <span class="at">data =</span> data_cr, <span class="at">link =</span> <span class="fu">mvlogit</span>(),</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>    <span class="at">coef.constraints =</span> <span class="fu">cbind</span>(<span class="at">LR =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>                             <span class="at">LEV =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>                             <span class="at">PR =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>                             <span class="at">RSIZE =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>                             <span class="at">BETA =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)),</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>    <span class="at">threshold.constraints =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span></code></pre></div>
<p>The results are displayed by:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">summary</span>(res_cor_logit)</span></code></pre></div>
<pre><code>## 
## Call: mvord(formula = MMO2(rater1, rater2, rater3, rater4) ~ 0 + LR + 
##     LEV + PR + RSIZE + BETA, data = data_cr, link = mvlogit(), 
##     coef.constraints = cbind(c(1, 1, 1, 1), c(1, 2, 3, 4), c(1, 
##         1, 1, 1), c(1, 1, 1, 2), c(1, 1, 2, 3)), threshold.constraints = c(1, 
##         1, 2, 3))
## 
## Formula: MMO2(rater1, rater2, rater3, rater4) ~ 0 + LR + LEV + PR + RSIZE + 
##     BETA
## 
##    link threshold nsubjects ndim    logPL   CLAIC   CLBIC fevals
## mvlogit  flexible       690    4 -2926.42 5987.81 6293.98   9338
## 
## Thresholds:
##            Estimate Std. Error z value  Pr(&gt;|z|)    
## rater1 A|B 15.04918    0.82409  18.262 &lt; 2.2e-16 ***
## rater1 B|C 17.75218    0.89728  19.785 &lt; 2.2e-16 ***
## rater1 C|D 20.97821    1.00773  20.817 &lt; 2.2e-16 ***
## rater1 D|E 25.13047    1.17487  21.390 &lt; 2.2e-16 ***
## rater3 F|G 14.47061    0.83922  17.243 &lt; 2.2e-16 ***
## rater3 G|H 17.17327    0.89515  19.185 &lt; 2.2e-16 ***
## rater3 H|I 20.56634    1.01119  20.339 &lt; 2.2e-16 ***
## rater3 I|J 23.00523    1.11045  20.717 &lt; 2.2e-16 ***
## rater3 J|K 24.97258    1.18725  21.034 &lt; 2.2e-16 ***
## rater4 L|M 23.92770    1.63196  14.662 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Coefficients:
##          Estimate Std. Error  z value  Pr(&gt;|z|)    
## LR 1     0.340210   0.110547   3.0775  0.002087 ** 
## LEV 1    0.784294   0.075977  10.3228 &lt; 2.2e-16 ***
## LEV 2    0.779694   0.078364   9.9496 &lt; 2.2e-16 ***
## LEV 3    0.718329   0.093425   7.6888 1.485e-14 ***
## LEV 4    1.107836   0.123681   8.9572 &lt; 2.2e-16 ***
## PR 1    -4.917963   0.343464 -14.3187 &lt; 2.2e-16 ***
## RSIZE 1 -2.093378   0.103690 -20.1889 &lt; 2.2e-16 ***
## RSIZE 2 -2.746163   0.188731 -14.5507 &lt; 2.2e-16 ***
## BETA 1   3.135692   0.221944  14.1283 &lt; 2.2e-16 ***
## BETA 2   2.733088   0.252960  10.8044 &lt; 2.2e-16 ***
## BETA 3   3.572691   0.349493  10.2225 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Error Structure:
##                    Estimate Std. Error z value  Pr(&gt;|z|)    
## corr rater1 rater2 0.859776   0.027907  30.809 &lt; 2.2e-16 ***
## corr rater1 rater3 0.908834   0.024636  36.891 &lt; 2.2e-16 ***
## corr rater1 rater4 0.903956   0.031858  28.374 &lt; 2.2e-16 ***
## corr rater2 rater3 0.834904   0.044259  18.864 &lt; 2.2e-16 ***
## corr rater2 rater4 0.932242   0.032173  28.976 &lt; 2.2e-16 ***
## corr rater3 rater4 0.856234   0.058392  14.664 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The constraints are displayed by:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">constraints</span>(res_cor_logit)</span></code></pre></div>
<pre><code>## $LR
##     LR 1
## A|B    1
## B|C    1
## C|D    1
## D|E    1
## A|B    1
## B|C    1
## C|D    1
## D|E    1
## F|G    1
## G|H    1
## H|I    1
## I|J    1
## J|K    1
## L|M    1
## 
## $LEV
##     LEV 1 LEV 2 LEV 3 LEV 4
## A|B     1     0     0     0
## B|C     1     0     0     0
## C|D     1     0     0     0
## D|E     1     0     0     0
## A|B     0     1     0     0
## B|C     0     1     0     0
## C|D     0     1     0     0
## D|E     0     1     0     0
## F|G     0     0     1     0
## G|H     0     0     1     0
## H|I     0     0     1     0
## I|J     0     0     1     0
## J|K     0     0     1     0
## L|M     0     0     0     1
## 
## $PR
##     PR 1
## A|B    1
## B|C    1
## C|D    1
## D|E    1
## A|B    1
## B|C    1
## C|D    1
## D|E    1
## F|G    1
## G|H    1
## H|I    1
## I|J    1
## J|K    1
## L|M    1
## 
## $RSIZE
##     RSIZE 1 RSIZE 2
## A|B       1       0
## B|C       1       0
## C|D       1       0
## D|E       1       0
## A|B       1       0
## B|C       1       0
## C|D       1       0
## D|E       1       0
## F|G       1       0
## G|H       1       0
## H|I       1       0
## I|J       1       0
## J|K       1       0
## L|M       0       1
## 
## $BETA
##     BETA 1 BETA 2 BETA 3
## A|B      1      0      0
## B|C      1      0      0
## C|D      1      0      0
## D|E      1      0      0
## A|B      1      0      0
## B|C      1      0      0
## C|D      1      0      0
## D|E      1      0      0
## F|G      0      1      0
## G|H      0      1      0
## H|I      0      1      0
## I|J      0      1      0
## J|K      0      1      0
## L|M      0      0      1</code></pre>
<p>Note that the composite likelihood information criteria can be used
for model comparison. For objects of class <code>mvord</code> the
composite likelihood AIC and BIC are computed by <code>AIC()</code> and
<code>BIC()</code>, respectively. The model fits of examples one and two
are compared by means of BIC and AIC. We observe that the model of
Example 3b has a lower BIC and AIC indicating a better model fit:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">BIC</span>(res_cor_probit_simple, res_cor_logit)</span></code></pre></div>
<pre><code>##                             df      BIC
## res_cor_probit_simple 92.85637 6458.641
## res_cor_logit         67.48687 6293.977</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">AIC</span>(res_cor_probit_simple)</span></code></pre></div>
<pre><code>## [1] 6037.38</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">AIC</span>(res_cor_logit)</span></code></pre></div>
<pre><code>## [1] 5987.81</code></pre>
<p>The value of the pairwise log-likelihood of the two models can be
extracted by:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">logLik</span>(res_cor_probit_simple)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -2925.834 (df=92.85637)</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">logLik</span>(res_cor_logit)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -2926.418 (df=67.48687)</code></pre>
<p>Marginal predictions are obtained by:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">marginal_predict</span>(res_cor_logit, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">table</span>(data_cr<span class="sc">$</span>rater1, mp<span class="sc">$</span>rater1)</span></code></pre></div>
<pre><code>##    
##       A   B   C   D   E
##   A  47  23   4   0   0
##   B  11  65  44   3   0
##   C   0  28 135  38   0
##   D   1   2  44 116  17
##   E   0   0   0  30  47</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">table</span>(data_cr<span class="sc">$</span>rater2, mp<span class="sc">$</span>rater2)</span></code></pre></div>
<pre><code>##    
##       A   B   C   D   E
##   A  29  20   8   0   0
##   B  12  41  22   2   0
##   C   1  18 103  24   0
##   D   0   0  35 109   7
##   E   0   0   0  13  39</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">table</span>(data_cr<span class="sc">$</span>rater3, mp<span class="sc">$</span>rater3)</span></code></pre></div>
<pre><code>##    
##      F  G  H  I  J  K
##   F 25  8  2  0  0  0
##   G  4 33 23  1  0  0
##   H  1 18 85 13  0  0
##   I  0  0 28 30  3  2
##   J  0  0  2 13 10  7
##   K  0  0  0  6  8 23</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">table</span>(data_cr<span class="sc">$</span>rater4, mp<span class="sc">$</span>rater4)</span></code></pre></div>
<pre><code>##    
##       L   M
##   L 195  40
##   M  30 425</code></pre>
<p>Joint predictions are obtained by:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>jp <span class="ot">&lt;-</span> <span class="fu">joint_probabilities</span>(res_cor_logit, </span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>                          <span class="at">response.cat =</span> data_cr[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],  </span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">table</span>(data_cr<span class="sc">$</span>rater1, jp<span class="sc">$</span>rater1)</span></code></pre></div>
<pre><code>##    
##       A   B   C   D   E
##   A  50  20   4   0   0
##   B  11  68  41   3   0
##   C   0  36 130  35   0
##   D   1   2  47 112  18
##   E   0   0   0  25  52</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="fu">table</span>(data_cr<span class="sc">$</span>rater2, jp<span class="sc">$</span>rater2)</span></code></pre></div>
<pre><code>##    
##       A   B   C   D   E
##   A  33  17   7   0   0
##   B  12  46  17   2   0
##   C   1  24  99  22   0
##   D   0   0  39 103   9
##   E   0   0   0  10  42</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">table</span>(data_cr<span class="sc">$</span>rater3, jp<span class="sc">$</span>rater3)</span></code></pre></div>
<pre><code>##    
##      F  G  H  I  J  K
##   F 27  7  1  0  0  0
##   G  6 33 21  1  0  0
##   H  1 24 77 15  0  0
##   I  0  0 25 35  1  2
##   J  0  0  2 17  3 10
##   K  0  0  0  9  1 27</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">table</span>(data_cr<span class="sc">$</span>rater4, jp<span class="sc">$</span>rater4)</span></code></pre></div>
<pre><code>##    
##       L   M
##   L 175  60
##   M  22 433</code></pre>
</div>
<div id="example-4---a-longitudinal-model" class="section level2">
<h2>Example 4 - A longitudinal model</h2>
<p>In this example, we present a longitudinal multivariate ordinal
probit regression model with a covariate dependent AR(1) error structure
using the data set data_cr_panel:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;data_cr_panel&quot;</span>, <span class="at">package =</span> <span class="st">&quot;mvord&quot;</span>)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a><span class="fu">str</span>(data_cr_panel, <span class="at">vec.len =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    11320 obs. of  9 variables:
##  $ rating : Ord.factor w/ 5 levels &quot;A&quot;&lt;&quot;B&quot;&lt;&quot;C&quot;&lt;&quot;D&quot;&lt;..: 5 3 3 3 3 1 3 3 ...
##  $ firm_id: int  1 2 3 4 5 6 7 8 ...
##  $ year   : Factor w/ 8 levels &quot;year1&quot;,&quot;year2&quot;,..: 1 1 1 1 1 1 1 1 ...
##  $ LR     : num  572.86 1.38 7.46 10.9 ...
##  $ LEV    : num  1.2008 0.0302 0.1517 0.5485 ...
##  $ PR     : num  0.1459 -0.0396 0.0508 0.1889 ...
##  $ RSIZE  : num  1.423 -1.944 2.024 -0.433 ...
##  $ BETA   : num  1.148 1.693 0.761 2.24 ...
##  $ BSEC   : Factor w/ 8 levels &quot;BSEC1&quot;,&quot;BSEC2&quot;,..: 3 6 3 7 6 7 7 7 ...</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="fu">head</span>(data_cr_panel, <span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   rating firm_id  year         LR        LEV          PR     RSIZE      BETA
## 1      E       1 year1 572.864658 1.20084294  0.14585117  1.422948 1.1481020
## 2      C       2 year1   1.379547 0.03022761 -0.03962597 -1.944265 1.6926956
## 3      C       3 year1   7.462706 0.15170420  0.05083517  2.024098 0.7610057
##    BSEC
## 1 BSEC3
## 2 BSEC6
## 3 BSEC3</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>res_AR1_probit <span class="ot">&lt;-</span> <span class="fu">mvord</span>(<span class="at">formula =</span> <span class="fu">MMO</span>(rating, firm_id, year) <span class="sc">~</span> LR <span class="sc">+</span> LEV <span class="sc">+</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>  PR <span class="sc">+</span> RSIZE <span class="sc">+</span> BETA, </span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>  <span class="at">error.structure =</span> <span class="fu">cor_ar1</span>(<span class="sc">~</span> BSEC), <span class="at">link =</span> <span class="fu">mvprobit</span>(),</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>  <span class="at">data =</span> data_cr_panel, </span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>  <span class="at">coef.constraints =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">4</span>)),</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>  <span class="at">threshold.constraints =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">8</span>), </span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>  <span class="at">threshold.values =</span> <span class="fu">rep</span>(<span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)),<span class="dv">8</span>),</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">mvord.control</span>(<span class="at">solver =</span> <span class="st">&quot;BFGS&quot;</span>))</span></code></pre></div>
<p>The results of the model can be presented by</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="fu">summary</span>(res_AR1_probit, <span class="at">short =</span> <span class="cn">TRUE</span>, <span class="at">call =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Formula: MMO(rating, firm_id, year) ~ LR + LEV + PR + RSIZE + BETA
## 
##     link threshold nsubjects ndim     logPL     CLAIC     CLBIC fevals
## mvprobit fix1first      1415    8 -74805.56 150098.19 151377.93    181
## 
## Thresholds:
##           Estimate Std. Error z value  Pr(&gt;|z|)    
## year1 A|B 0.000000   0.000000      NA        NA    
## year1 B|C 1.016137   0.026379  38.521 &lt; 2.2e-16 ***
## year1 C|D 2.444887   0.041170  59.385 &lt; 2.2e-16 ***
## year1 D|E 3.891073   0.058843  66.127 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Coefficients:
##                 Estimate Std. Error  z value  Pr(&gt;|z|)    
## (Intercept) 1  1.4190682  0.0532243  26.6620 &lt; 2.2e-16 ***
## (Intercept) 2  1.4975500  0.0494038  30.3124 &lt; 2.2e-16 ***
## LR 1           0.0193546  0.0006938  27.8966 &lt; 2.2e-16 ***
## LR 2           0.0323230  0.0010102  31.9955 &lt; 2.2e-16 ***
## LEV 1          0.0268125  0.0019263  13.9191 &lt; 2.2e-16 ***
## LEV 2          0.0180050  0.0013143  13.6993 &lt; 2.2e-16 ***
## PR 1          -1.0930080  0.0427073 -25.5930 &lt; 2.2e-16 ***
## PR 2          -0.7411681  0.0372295 -19.9081 &lt; 2.2e-16 ***
## RSIZE 1       -0.3676665  0.0114038 -32.2407 &lt; 2.2e-16 ***
## RSIZE 2       -0.3608979  0.0115297 -31.3016 &lt; 2.2e-16 ***
## BETA 1         0.0541624  0.0296028   1.8296    0.0673 .  
## BETA 2         0.1099998  0.0236754   4.6462 3.382e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Error Structure:
##              Estimate Std. Error  z value  Pr(&gt;|z|)    
## (Intercept)  1.490395   0.051540  28.9173 &lt; 2.2e-16 ***
## BSECBSEC2   -0.552317   0.069241  -7.9767 1.503e-15 ***
## BSECBSEC3   -0.062028   0.066553  -0.9320    0.3513    
## BSECBSEC4   -0.085592   0.065126  -1.3142    0.1888    
## BSECBSEC5   -0.066598   0.085692  -0.7772    0.4371    
## BSECBSEC6   -0.683429   0.069184  -9.8785 &lt; 2.2e-16 ***
## BSECBSEC7   -0.863911   0.064855 -13.3206 &lt; 2.2e-16 ***
## BSECBSEC8   -0.757997   0.078506  -9.6553 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The default error structure output for AR(1) models:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="fu">error_structure</span>(res_AR1_probit)</span></code></pre></div>
<pre><code>##         V16         V17         V18         V19         V20         V21 
##  1.49039489 -0.55231725 -0.06202790 -0.08559155 -0.06659849 -0.68342920 
##         V22         V23 
## -0.86391149 -0.75799729</code></pre>
<p>Correlation parameters <span class="math inline">\(\rho_i\)</span>
for each firm are obtained by choosing <code>type = &quot;corr&quot;</code> in
<code>error_structure()</code>:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">error_structure</span>(res_AR1_probit, <span class="at">type =</span> <span class="st">&quot;corr&quot;</span>), <span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   Correlation
## 1   0.8913315
## 2   0.6679130
## 3   0.8913315</code></pre>
<p>Correlation matrices for each specific firm are obtained by choosing
<code>type = &quot;sigmas&quot;</code>:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">error_structure</span>(res_AR1_probit, <span class="at">type =</span> <span class="st">&quot;sigmas&quot;</span>), <span class="at">n =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## $`1`
##           year1     year2     year3     year4     year5     year6     year7
## year1 1.0000000 0.8913315 0.7944718 0.7081377 0.6311854 0.5625954 0.5014590
## year2 0.8913315 1.0000000 0.8913315 0.7944718 0.7081377 0.6311854 0.5625954
## year3 0.7944718 0.8913315 1.0000000 0.8913315 0.7944718 0.7081377 0.6311854
## year4 0.7081377 0.7944718 0.8913315 1.0000000 0.8913315 0.7944718 0.7081377
## year5 0.6311854 0.7081377 0.7944718 0.8913315 1.0000000 0.8913315 0.7944718
## year6 0.5625954 0.6311854 0.7081377 0.7944718 0.8913315 1.0000000 0.8913315
## year7 0.5014590 0.5625954 0.6311854 0.7081377 0.7944718 0.8913315 1.0000000
## year8 0.4469662 0.5014590 0.5625954 0.6311854 0.7081377 0.7944718 0.8913315
##           year8
## year1 0.4469662
## year2 0.5014590
## year3 0.5625954
## year4 0.6311854
## year5 0.7081377
## year6 0.7944718
## year7 0.8913315
## year8 1.0000000</code></pre>
</div>
<div id="example-5---self-reported-health-status" class="section level2">
<h2>Example 5 - Self-reported health status</h2>
<p>In this example we analyze longitudinal data on self-reported health
status measured on a five point ordinal scale (5 = <em>poor</em>, 4 =
<em>fair</em>, 3 = <em>good</em>, 2 = <em>very good</em> and 1 =
<em>excellent</em>) derived from the Health and Retirement Study
conducted by the University of Michigan which is available in the
<strong>LMest</strong> package:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">data</span>(data_SRHS_long, <span class="at">package =</span> <span class="st">&quot;LMest&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="fu">str</span>(data_SRHS_long)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    56592 obs. of  7 variables:
##  $ t        : int  1 2 3 4 5 6 7 8 1 2 ...
##  $ id       : num  1 1 1 1 1 1 1 1 2 2 ...
##  $ gender   : num  1 1 1 1 1 1 1 1 2 2 ...
##  $ race     : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ education: num  3 3 3 3 3 3 3 3 5 5 ...
##  $ age      : num  56 58 60 62 64 66 68 70 54 55 ...
##  $ srhs     : num  4 4 3 3 4 3 3 3 3 3 ...</code></pre>
<p>The dataset contains a self-reported health status <code>srhs</code>
together with covariates such as ethnicity (<code>race</code> coded as 1
= <em>white</em>, 2 = <em>black</em>, 3 = <em>others</em>),
<code>gender</code> (coded as 1 = <em>male</em>, 2 = <em>female</em>),
<code>education</code> level (coded as 1 = <em>high school</em>, 2 =
<em>general educational diploma</em>, 3 = <em>high school graduate</em>,
4 = <em>some college</em>, 5 = <em>college and above</em>) and
<code>age</code> for 7074 subjects on 8 different (approximately equally
spaced) time occasions `t``.</p>
<p>We estimate a multivariate ordinal logit model similar to the one of
the models employed by <span class="citation">Bartolucci, Pandolfi, and
Pennoni (2017)</span>, where for every subject in the sample the errors
follow an <span class="math inline">\(AR(1)\)</span> process. Moreover,
the threshold and regression coefficients are equal across all years. In
order to reduce the computational burden we only consider pairs of
observations not more than two time points appart by setting
<code>PL.lag = 2</code>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a>res_srhs <span class="ot">&lt;-</span> <span class="fu">mvord</span>(<span class="at">formula =</span> <span class="fu">MMO</span>(srhs, id, t) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">factor</span>(gender) <span class="sc">+</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>    <span class="fu">factor</span>(race) <span class="sc">+</span> <span class="fu">factor</span>(education) <span class="sc">+</span> age, </span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>    <span class="at">data =</span> data_SRHS_long,</span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a>    <span class="at">threshold.constraints =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">8</span>), </span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>    <span class="at">coef.constraints =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">8</span>),</span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a>    <span class="at">error.structure =</span> <span class="fu">cor_ar1</span>(<span class="sc">~</span> <span class="dv">1</span>), <span class="at">link =</span> <span class="fu">mvlogit</span>(), </span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a>    <span class="at">PL.lag =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>(runtime 12 minutes).</p>
<p>The persistence in the reported health status is high. The
correlation parameter in the <code>cor_ar1</code> error structure is</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">unique</span>(<span class="fu">error_structure</span>(res_srhs, <span class="at">type =</span> <span class="st">&quot;corr&quot;</span>))</span></code></pre></div>
<pre><code>##   Correlation
## 1   0.8820163</code></pre>
<p>The estimated parameters are shown by the function
<code>summary()</code>:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">summary</span>(res_srhs, <span class="at">call =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Formula: MMO(srhs, id, time) ~ 0 + factor(gender) + factor(race) + factor(education) + 
##     age
## 
##    link threshold nsubjects ndim      logPL     CLAIC     CLBIC fevals
## mvlogit  flexible      7074    8 -239860.22 479933.65 480665.42    404
## 
## Thresholds:
##       Estimate Std. Error  z value Pr(&gt;|z|)    
## 1 1|2 -1.78119    0.11595 -15.3621   &lt;2e-16 ***
## 1 2|3 -0.11563    0.11679  -0.9901   0.3221    
## 1 3|4  1.40676    0.11857  11.8644   &lt;2e-16 ***
## 1 4|5  3.03358    0.12245  24.7741   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Coefficients:
##                        Estimate Std. Error  z value  Pr(&gt;|z|)    
## factor(gender)2 1    -0.0059763  0.0382602  -0.1562    0.8759    
## factor(race)2 1       0.6083505  0.0560734  10.8492 &lt; 2.2e-16 ***
## factor(race)3 1       0.5050706  0.0994654   5.0779 3.817e-07 ***
## factor(education)2 1 -0.5344365  0.0889470  -6.0085 1.873e-09 ***
## factor(education)3 1 -1.0114449  0.0516341 -19.5887 &lt; 2.2e-16 ***
## factor(education)4 1 -1.3037171  0.0583832 -22.3304 &lt; 2.2e-16 ***
## factor(education)5 1 -1.7340257  0.0603490 -28.7333 &lt; 2.2e-16 ***
## age 1                 0.0161467  0.0016881   9.5649 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Error Structure:
##              Estimate Std. Error z value  Pr(&gt;|z|)    
## (Intercept) 1.3847764  0.0088376  156.69 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>In the logit model the coefficients can be interpreted in terms of
log-odds ratios. The results suggest that being non-white increases the
chances of reporting a worse health status while higher people with
education levels tend to report better health. Moreover, every
additional year increases the odds of reporting a worse health status by
1.64% (<span class="math inline">\(exp(0.0162628)=1.016396\)</span>).</p>
</div>
<div id="example-6---multirater-agreement-data" class="section level2">
<h2>Example 6 - Multirater agreement data</h2>
<p>The <strong>mvord</strong> package can also be employed to measure
agreement among several rating sources either with or without additional
relevant covariate information.</p>
<p>We use the multirater agreement data from Chapter 5 in <span class="citation">Johnson and Albert (1999)</span>. These data consist of
grades assigned to 198 essays by 5 experts, each of whom rated all
essays on a 10-point scale. A score of 10 indicates an excellent essay.
In addition, the average word length is also available as an essay
characteristic. The data set can be loaded from the package:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;essay_data&quot;</span>, <span class="at">package =</span> <span class="st">&quot;mvord&quot;</span>)</span></code></pre></div>
<p>The traditional measure of agreement between raters in the social
sciences is the polychoric correlation. The polychoric correlation can
be assessed using the <strong>mvord</strong> package by estimating of a
model with no covariates and probit link. The correlation parameters of
the <code>cor_general</code> error structure are to be interpreted as
the measure of agreement.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">head</span>(essay_data)</span></code></pre></div>
<pre><code>##   Judge1 Judge2 Judge3 Judge4 Judge5    wl
## 1      8      6      9     10      5 4.760
## 2      7      5      3      5      3 4.244
## 3      2      1      1      1      1 4.087
## 4      5      3      4      5      3 4.355
## 5      7      2      7      7      7 4.306
## 6     10      6      8     10      6 4.508</code></pre>
<p>The data is in the wide format (each ordinal response is in one
column) so the <code>MMO2</code> object will be used in the
<code>formula</code> object:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a>res_essay_0 <span class="ot">&lt;-</span> <span class="fu">mvord</span>(</span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">MMO2</span>(Judge1, Judge2, Judge3, Judge4, Judge5) <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>  <span class="at">data =</span> essay_data, <span class="at">threshold.constraints =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>  <span class="at">coef.constraints =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>))</span></code></pre></div>
<p>(runtime 14 seconds).</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="fu">summary</span>(res_essay_0, <span class="at">call =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Formula: MMO2(Judge1, Judge2, Judge3, Judge4, Judge5) ~ -1
## 
##     link threshold nsubjects ndim    logPL    CLAIC    CLBIC fevals
## mvprobit  flexible       198    5 -8528.42 17172.01 17361.38   1443
## 
## Thresholds:
##               Estimate Std. Error  z value  Pr(&gt;|z|)    
## Judge1 1|2  -1.2448340  0.0795063 -15.6571 &lt; 2.2e-16 ***
## Judge1 2|3  -0.6634138  0.0676890  -9.8009 &lt; 2.2e-16 ***
## Judge1 3|4  -0.3297115  0.0651692  -5.0593 4.208e-07 ***
## Judge1 4|5   0.0001387  0.0632803   0.0022    0.9983    
## Judge1 5|6   0.3496646  0.0654689   5.3409 9.247e-08 ***
## Judge1 6|7   0.6352872  0.0668804   9.4989 &lt; 2.2e-16 ***
## Judge1 7|8   0.9937520  0.0740965  13.4116 &lt; 2.2e-16 ***
## Judge1 8|9   1.3344835  0.0806365  16.5494 &lt; 2.2e-16 ***
## Judge1 9|10  1.9196999  0.1064901  18.0270 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Coefficients:
##      Estimate Std. Error z value Pr(&gt;|z|)
## 
## Error Structure:
##                    Estimate Std. Error z value  Pr(&gt;|z|)    
## corr Judge1 Judge2 0.476080   0.061835  7.6992 1.369e-14 ***
## corr Judge1 Judge3 0.569194   0.046682 12.1930 &lt; 2.2e-16 ***
## corr Judge1 Judge4 0.645198   0.046595 13.8468 &lt; 2.2e-16 ***
## corr Judge1 Judge5 0.322528   0.090319  3.5710 0.0003556 ***
## corr Judge2 Judge3 0.396377   0.056243  7.0475 1.821e-12 ***
## corr Judge2 Judge4 0.634422   0.046930 13.5186 &lt; 2.2e-16 ***
## corr Judge2 Judge5 0.621900   0.041815 14.8725 &lt; 2.2e-16 ***
## corr Judge3 Judge4 0.391911   0.072272  5.4227 5.871e-08 ***
## corr Judge3 Judge5 0.382999   0.066020  5.8013 6.582e-09 ***
## corr Judge4 Judge5 0.693040   0.041727 16.6087 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The word length can be included as a covariate in the model:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a>res_essay_wl <span class="ot">&lt;-</span> <span class="fu">mvord</span>(</span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">MMO2</span>(Judge1, Judge2, Judge3, Judge4, Judge5) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> wl,</span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>  <span class="at">data =</span> essay_data, <span class="at">threshold.constraints =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>  <span class="at">coef.constraints =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>))</span></code></pre></div>
<p>(runtime 0 minutes).</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="fu">summary</span>(res_essay_wl, <span class="at">call =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Formula: MMO2(Judge1, Judge2, Judge3, Judge4, Judge5) ~ 0 + wl
## 
##     link threshold nsubjects ndim    logPL    CLAIC    CLBIC fevals
## mvprobit  flexible       198    5 -8488.74 17110.73 17329.81   2161
## 
## Thresholds:
##             Estimate Std. Error z value  Pr(&gt;|z|)    
## Judge1 1|2   1.09799    0.78039  1.4070 0.1594326    
## Judge1 2|3   1.68728    0.78221  2.1571 0.0309994 *  
## Judge1 3|4   2.02523    0.78287  2.5869 0.0096838 ** 
## Judge1 4|5   2.36059    0.78294  3.0150 0.0025694 ** 
## Judge1 5|6   2.71667    0.78472  3.4620 0.0005362 ***
## Judge1 6|7   3.00649    0.78550  3.8275 0.0001295 ***
## Judge1 7|8   3.36963    0.78891  4.2712 1.944e-05 ***
## Judge1 8|9   3.71636    0.79304  4.6862 2.783e-06 ***
## Judge1 9|10  4.31272    0.79820  5.4031 6.551e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Coefficients:
##      Estimate Std. Error z value Pr(&gt;|z|)   
## wl 1  0.54193    0.17837  3.0382  0.00238 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Error Structure:
##                    Estimate Std. Error z value  Pr(&gt;|z|)    
## corr Judge1 Judge2 0.459154   0.062913  7.2983 2.915e-13 ***
## corr Judge1 Judge3 0.558919   0.047414 11.7881 &lt; 2.2e-16 ***
## corr Judge1 Judge4 0.631977   0.048175 13.1182 &lt; 2.2e-16 ***
## corr Judge1 Judge5 0.295951   0.089837  3.2943 0.0009866 ***
## corr Judge2 Judge3 0.382554   0.056902  6.7230 1.780e-11 ***
## corr Judge2 Judge4 0.621086   0.048802 12.7266 &lt; 2.2e-16 ***
## corr Judge2 Judge5 0.608996   0.043499 14.0004 &lt; 2.2e-16 ***
## corr Judge3 Judge4 0.374731   0.073984  5.0651 4.083e-07 ***
## corr Judge3 Judge5 0.368174   0.067220  5.4772 4.322e-08 ***
## corr Judge4 Judge5 0.681338   0.044116 15.4442 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The probabilities of agreement among all five judges which implied by
the model can be computed by the function
<code>joint_probabilities()</code>:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a>agree_prob_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i)</span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a>  <span class="fu">joint_probabilities</span>(res_essay_wl, <span class="fu">rep</span>(i, <span class="dv">5</span>)))</span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a>agree_prob <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="st">&quot;+&quot;</span>, agree_prob_list)</span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a><span class="fu">summary</span>(agree_prob)</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## 0.005150 0.006445 0.008724 0.009701 0.011795 0.023869</code></pre>
<p>In order to assess the relationship between the average word length
and the agreement probabilities, we plot the probabilities of agreement
implied by the model against the word length.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="fu">plot</span>(essay_data<span class="sc">$</span>wl, agree_prob,</span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;word length&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;probability of agreement&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<!-- \begin{center} -->
<!-- \begin{figure}[!h] -->
<!-- \caption{Probabilities of agreement between the five raters and word length} -->
<!-- <<echo=F, fig=T>>= -->
<!-- plot(df$wl, agree_prob, -->
<!--   xlab = "word length", ylab = "probability of agreement") -->
<!-- ``` -->
<!-- \label{fig:agree} -->
<!-- \end{figure} -->
<!-- \end{center} -->
<p>The graphic suggests that the judges tend to agree more on the
quality of essays with lower average word length than on the essays with
larger average word length.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Bartolucci14" class="csl-entry">
Bartolucci, Francesco, Silvia Pandolfi, and Fulvia Pennoni. 2017.
<span>“<span>LMest</span>: An <span>R</span> Package for Latent Markov
Models for Longitudinal Categorical Data.”</span> <em>Journal of
Statistical Software</em> 81 (4): 1–38. <a href="https://doi.org/10.18637/jss.v081.i04">https://doi.org/10.18637/jss.v081.i04</a>.
</div>
<div id="ref-johnson1999ordinal" class="csl-entry">
Johnson, Valen E, and J Albert. 1999. <em>Ordinal Data Modeling</em>.
Statistics for Social Science and Public Policy. Springer-Verlag New
York Incorporated.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
